<!DOCTYPE html>

<html>
<head>
  <title>ntm_ui_slider.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>ntm_ui_slider.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * Module with NTM slider support functions.
 */</span>
<span class="hljs-keyword">var</span> ntmSlider = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(module)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>var YEARS = [“1945”, “1950”, “1955”, “1960”, “1965”, “1970”, “1975”, “1980”, “1985”, “1990”, “1995”, “2000”, “2005”, “2010”, “2015”];
all years</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> slider_years = [<span class="hljs-string">'1945'</span>, <span class="hljs-string">'1946'</span>, <span class="hljs-string">'1947'</span>, <span class="hljs-string">'1948'</span>, <span class="hljs-string">'1949'</span>, <span class="hljs-string">'1950'</span>, <span class="hljs-string">'1951'</span>, <span class="hljs-string">'1952'</span>, <span class="hljs-string">'1953'</span>, <span class="hljs-string">'1954'</span>, <span class="hljs-string">'1955'</span>, <span class="hljs-string">'1956'</span>, <span class="hljs-string">'1957'</span>, <span class="hljs-string">'1958'</span>, <span class="hljs-string">'1959'</span>, <span class="hljs-string">'1960'</span>, <span class="hljs-string">'1961'</span>, <span class="hljs-string">'1962'</span>, <span class="hljs-string">'1963'</span>, <span class="hljs-string">'1964'</span>, <span class="hljs-string">'1965'</span>, <span class="hljs-string">'1966'</span>, <span class="hljs-string">'1967'</span>, <span class="hljs-string">'1968'</span>, <span class="hljs-string">'1969'</span>, <span class="hljs-string">'1970'</span>, <span class="hljs-string">'1971'</span>, <span class="hljs-string">'1972'</span>, <span class="hljs-string">'1973'</span>, <span class="hljs-string">'1974'</span>, <span class="hljs-string">'1975'</span>, <span class="hljs-string">'1976'</span>, <span class="hljs-string">'1977'</span>, <span class="hljs-string">'1978'</span>, <span class="hljs-string">'1979'</span>, <span class="hljs-string">'1980'</span>, <span class="hljs-string">'1981'</span>, <span class="hljs-string">'1982'</span>, <span class="hljs-string">'1983'</span>, <span class="hljs-string">'1984'</span>, <span class="hljs-string">'1985'</span>, <span class="hljs-string">'1986'</span>, <span class="hljs-string">'1987'</span>, <span class="hljs-string">'1988'</span>, <span class="hljs-string">'1989'</span>, <span class="hljs-string">'1990'</span>, <span class="hljs-string">'1991'</span>, <span class="hljs-string">'1992'</span>, <span class="hljs-string">'1993'</span>, <span class="hljs-string">'1994'</span>, <span class="hljs-string">'1995'</span>, <span class="hljs-string">'1996'</span>, <span class="hljs-string">'1997'</span>, <span class="hljs-string">'1998'</span>, <span class="hljs-string">'1999'</span>, <span class="hljs-string">'2000'</span>, <span class="hljs-string">'2001'</span>, <span class="hljs-string">'2002'</span>, <span class="hljs-string">'2003'</span>, <span class="hljs-string">'2004'</span>, <span class="hljs-string">'2005'</span>, <span class="hljs-string">'2006'</span>, <span class="hljs-string">'2007'</span>, <span class="hljs-string">'2008'</span>, <span class="hljs-string">'2009'</span>, <span class="hljs-string">'2010'</span>, <span class="hljs-string">'2011'</span>, <span class="hljs-string">'2012'</span>, <span class="hljs-string">'2013'</span>];
	<span class="hljs-keyword">var</span> slider_ints = [<span class="hljs-number">1945</span>, <span class="hljs-number">1946</span>, <span class="hljs-number">1947</span>, <span class="hljs-number">1948</span>, <span class="hljs-number">1949</span>, <span class="hljs-number">1950</span>, <span class="hljs-number">1951</span>, <span class="hljs-number">1952</span>, <span class="hljs-number">1953</span>, <span class="hljs-number">1954</span>, <span class="hljs-number">1955</span>, <span class="hljs-number">1956</span>, <span class="hljs-number">1957</span>, <span class="hljs-number">1958</span>, <span class="hljs-number">1959</span>, <span class="hljs-number">1960</span>, <span class="hljs-number">1961</span>, <span class="hljs-number">1962</span>, <span class="hljs-number">1963</span>, <span class="hljs-number">1964</span>, <span class="hljs-number">1965</span>, <span class="hljs-number">1966</span>, <span class="hljs-number">1967</span>, <span class="hljs-number">1968</span>, <span class="hljs-number">1969</span>, <span class="hljs-number">1970</span>, <span class="hljs-number">1971</span>, <span class="hljs-number">1972</span>, <span class="hljs-number">1973</span>, <span class="hljs-number">1974</span>, <span class="hljs-number">1975</span>, <span class="hljs-number">1976</span>, <span class="hljs-number">1977</span>, <span class="hljs-number">1978</span>, <span class="hljs-number">1979</span>, <span class="hljs-number">1980</span>, <span class="hljs-number">1981</span>, <span class="hljs-number">1982</span>, <span class="hljs-number">1983</span>, <span class="hljs-number">1984</span>, <span class="hljs-number">1985</span>, <span class="hljs-number">1986</span>, <span class="hljs-number">1987</span>, <span class="hljs-number">1988</span>, <span class="hljs-number">1989</span>, <span class="hljs-number">1990</span>, <span class="hljs-number">1991</span>, <span class="hljs-number">1992</span>, <span class="hljs-number">1993</span>, <span class="hljs-number">1994</span>, <span class="hljs-number">1995</span>, <span class="hljs-number">1996</span>, <span class="hljs-number">1997</span>, <span class="hljs-number">1998</span>, <span class="hljs-number">1999</span>, <span class="hljs-number">2000</span>, <span class="hljs-number">2001</span>, <span class="hljs-number">2002</span>, <span class="hljs-number">2003</span>, <span class="hljs-number">2004</span>, <span class="hljs-number">2005</span>, <span class="hljs-number">2006</span>, <span class="hljs-number">2007</span>, <span class="hljs-number">2008</span>, <span class="hljs-number">2009</span>, <span class="hljs-number">2010</span>, <span class="hljs-number">2011</span>, <span class="hljs-number">2012</span>, <span class="hljs-number">2013</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>years with a nuclear test</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> test_years = [<span class="hljs-number">1945</span>, <span class="hljs-number">1946</span>, <span class="hljs-number">1948</span>, <span class="hljs-number">1949</span>, <span class="hljs-number">1951</span>, <span class="hljs-number">1952</span>, <span class="hljs-number">1953</span>, <span class="hljs-number">1954</span>, <span class="hljs-number">1955</span>, <span class="hljs-number">1956</span>, <span class="hljs-number">1957</span>, <span class="hljs-number">1958</span>, <span class="hljs-number">1960</span>, <span class="hljs-number">1961</span>, <span class="hljs-number">1962</span>, <span class="hljs-number">1963</span>, <span class="hljs-number">1964</span>, <span class="hljs-number">1965</span>, <span class="hljs-number">1966</span>, <span class="hljs-number">1967</span>, <span class="hljs-number">1968</span>, <span class="hljs-number">1969</span>, <span class="hljs-number">1970</span>, <span class="hljs-number">1971</span>, <span class="hljs-number">1972</span>, <span class="hljs-number">1973</span>, <span class="hljs-number">1974</span>, <span class="hljs-number">1975</span>, <span class="hljs-number">1976</span>, <span class="hljs-number">1977</span>, <span class="hljs-number">1978</span>, <span class="hljs-number">1979</span>, <span class="hljs-number">1980</span>, <span class="hljs-number">1981</span>, <span class="hljs-number">1982</span>, <span class="hljs-number">1983</span>, <span class="hljs-number">1984</span>, <span class="hljs-number">1985</span>, <span class="hljs-number">1986</span>, <span class="hljs-number">1987</span>, <span class="hljs-number">1988</span>, <span class="hljs-number">1989</span>, <span class="hljs-number">1990</span>, <span class="hljs-number">1991</span>, <span class="hljs-number">1992</span>, <span class="hljs-number">1994</span>, <span class="hljs-number">1995</span>, <span class="hljs-number">1996</span>, <span class="hljs-number">1998</span>, <span class="hljs-number">2006</span>, <span class="hljs-number">2009</span>, <span class="hljs-number">2013</span>];

	<span class="hljs-comment">/**
	 * Slider div with year spans.
	 */</span>
	<span class="hljs-built_in">module</span>.sliElem = <span class="hljs-literal">null</span>;

	<span class="hljs-keyword">var</span> toYear = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(num)</span> </span>{
		<span class="hljs-keyword">return</span> slider_years[num].substring(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>);
	};

	<span class="hljs-built_in">module</span>.init = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
		<span class="hljs-built_in">module</span>.sliElem = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"slider-content"</span>);
		<span class="hljs-built_in">module</span>.sliElem.style.visibility = <span class="hljs-string">"visible"</span>;
		<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"slider-control-btn"</span>).style.visibility = <span class="hljs-string">"visible"</span>;
		<span class="hljs-built_in">module</span>.sliElem.innerHTML = <span class="hljs-string">""</span>;
		<span class="hljs-keyword">var</span> testNumbers = ntmDataApi.loadTestNumbers();

		<span class="hljs-keyword">var</span> year0 = <span class="hljs-number">1945</span>;

		<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">69</span>; i++) {
			<span class="hljs-keyword">var</span> element = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'span'</span>);
			element.setAttribute(<span class="hljs-string">"id"</span>, <span class="hljs-string">"years-"</span> + slider_ints[i]);
			<span class="hljs-keyword">var</span> classes = <span class="hljs-string">"slider-year"</span>;
			<span class="hljs-keyword">if</span> (i === <span class="hljs-number">0</span>) {
				classes = classes + <span class="hljs-string">" active"</span>;
			} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (test_years.indexOf(i) &gt; -<span class="hljs-number">1</span>) {
				classes = classes + <span class="hljs-string">" passive"</span>;
			} <span class="hljs-keyword">else</span> {
				classes = classes + <span class="hljs-string">" notest"</span>;
			}
			element.setAttribute(<span class="hljs-string">"class"</span>, classes);
			element.setAttribute(<span class="hljs-string">"data-year"</span>, (i).toString());
			element.setAttribute(<span class="hljs-string">"data-switch-to-year"</span>, slider_ints[i]);

			tooltipCountries = {
				<span class="hljs-string">"US"</span> : <span class="hljs-string">"USA"</span>,
				<span class="hljs-string">"FR"</span> : <span class="hljs-string">"France"</span>,
				<span class="hljs-string">"PC"</span> : <span class="hljs-string">"China"</span>,
				<span class="hljs-string">"PK"</span> : <span class="hljs-string">"Pakistan"</span>,
				<span class="hljs-string">"NK"</span> : <span class="hljs-string">"DPRK"</span>,
				<span class="hljs-string">"CP"</span> : <span class="hljs-string">"CPPP"</span>,
				<span class="hljs-string">"IS"</span> : <span class="hljs-string">"Israel (alleged)"</span>,
				<span class="hljs-string">"IN"</span> : <span class="hljs-string">"India"</span>,
				<span class="hljs-string">"GB"</span> : <span class="hljs-string">"UK"</span>
			};

			<span class="hljs-keyword">var</span> tooltip = <span class="hljs-string">""</span>;
			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> country <span class="hljs-keyword">in</span> testNumbers[<span class="hljs-number">1945</span> + i]) {
				tooltip += tooltipCountries[country] + <span class="hljs-string">": "</span> + testNumbers[<span class="hljs-number">1945</span>+i][country] + <span class="hljs-string">", "</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>slider_years[i].US;
tooltip += “<img src='../img/"+country+".png' alt=''/> “+testNumbers[1945+i][country]+”, “; //slider_years[i].US;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			}

			<span class="hljs-keyword">if</span> (tooltip === <span class="hljs-string">""</span>) {
				tooltip = <span class="hljs-string">"No nuclear tests were cunducted this year.."</span>;
			}

			<span class="hljs-keyword">var</span> ttl = tooltip.length - <span class="hljs-number">2</span>;
			element.setAttribute(<span class="hljs-string">"tooltip"</span>, tooltip.substring(<span class="hljs-number">0</span>, ttl));
			element.textContent = toYear(i);

			<span class="hljs-built_in">module</span>.sliElem.appendChild(element);
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Add onclick handler for switching to slider year.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-built_in">module</span>.sliElem.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span> </span>{
			<span class="hljs-keyword">var</span> switchYear = e.toElement.getAttribute(<span class="hljs-string">"data-switch-to-year"</span>);
			ntmUI.player.switchTo(switchYear);
		});

	};

	<span class="hljs-built_in">module</span>.onDataShapeShow = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(dataShape)</span> </span>{
		<span class="hljs-keyword">var</span> classes = <span class="hljs-string">"slider-year"</span>;

		<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">52</span>; i++) {
			<span class="hljs-keyword">var</span> curElement = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"years-"</span> + (test_years[i]));
			curElement.setAttribute(<span class="hljs-string">"class"</span>, classes + <span class="hljs-string">" passive"</span>);
		}

		<span class="hljs-keyword">var</span> element = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"years-"</span> + dataShape.dstr.substring(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>));
		element.setAttribute(<span class="hljs-string">"class"</span>, classes + <span class="hljs-string">" active"</span>);
	};

	<span class="hljs-keyword">return</span> <span class="hljs-built_in">module</span>;
}(ntmSlider || {});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
